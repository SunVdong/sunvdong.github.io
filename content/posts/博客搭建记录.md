---
title: "åšå®¢æ­å»ºè®°å½•"
date: 2021-11-03T15:46:20+08:00
lastmod: 2022-05-30T20:00:00+08:00
draft: false
author: vdong
categories: 
- æŠ€æœ¯
tags:
- hugo
- æŠ˜è…¾
---

è¿™æ˜¯ä¸€ä¸ªé™æ€ bolg ç½‘ç«™ã€‚

è®°å½•æ­å»ºè¿‡ç¨‹ã€‚

## æŠ€æœ¯æ ˆï¼š

hugo , git , github ã€‚

- hugoï¼šæ˜¯ä¸€ä¸ªå¼€æºçš„ web æ¡†æ¶ï¼Œä½¿ç”¨ go è¯­è¨€å¼€å‘ï¼Œå¯ä»¥å°† markdown æ–‡ä»¶å¿«é€Ÿçš„å»ºæ„æˆé™æ€ç½‘ç«™ã€‚

- git: ä½œä¸ºç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚

- github: ä½œä¸ºä»£ç ä»“åº“ï¼Œä½¿ç”¨ github çš„ actions åšè‡ªåŠ¨çš„å»ºæ„å’Œéƒ¨ç½²ï¼Œåˆ†åˆ«éƒ¨ç½²åœ¨ github pages å’Œ é˜¿é‡Œäº‘ä¸Šã€‚

## æ­å»ºè¿‡ç¨‹

### æœ¬åœ°å®‰è£… hugo

ä¸åŒæ“ä½œç³»ç»Ÿå®‰è£…å·®å¼‚ç•¥æœ‰ä¸åŒï¼Œå…·ä½“è¯·å‚è€ƒï¼š[å®‰è£…æ–‡æ¡£](https://gohugo.io/getting-started/installing/)

æœ¬äººä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…

```shell
# Hugo extended æ”¯æŒ Sass/SCSS
scoop install hugo-extended
```

### åˆ›å»ºç«™ç‚¹ï¼Œæµ‹è¯•

å‚è€ƒ[å¿«é€Ÿå¼€å§‹](https://gohugo.io/getting-started/quick-start/)åˆ›å»ºç«™ç‚¹ï¼Œå¹¶æµ‹è¯•ã€‚

æœ¬äººé€‰æ‹©çš„ä¸»é¢˜æ˜¯ [Doit](https://github.com/HEIGE-PCloud/DoIt)ï¼Œå¹¶ä½œç®€å•é…ç½®ï¼ˆä¿®æ”¹ `config.toml` æ–‡ä»¶ï¼‰å³å¯ï¼Œå…ˆè·‘èµ·æ¥ã€‚

è‡³æ­¤åšå®¢å·²ç»æ­å»ºå®Œæˆï¼Œä½ å¯ä»¥æ·»åŠ å†…å®¹ï¼Œåœ¨æœ¬åœ°æµè§ˆåšå®¢ï¼Œç”Ÿæˆé™æ€æ–‡ä»¶ï¼ˆé»˜è®¤ `public/` ç›®å½•ä¸‹ï¼‰ï¼Œä¸Šä¼  `public/` ç›®å½•çš„ä¸‹çš„å†…å®¹åˆ°æœåŠ¡å™¨ï¼Œå°±æ˜¯ä¸€ä¸ªé™æ€çš„`blog` ç½‘ç«™ã€‚

### æ·»åŠ ç‰ˆæœ¬ç®¡ç†

æœ¬åœ°ï¼šè¿›å…¥ç«™ç‚¹ç›®å½•ï¼Œ`git init` å°†è¯¥ç›®å½•å˜æˆä¸€ä¸ªä»“åº“ï¼›ä¹‹åæ­£å¸¸åšç‰ˆæœ¬ç®¡ç†ã€‚

githubçº¿ä¸Š: åˆ›å»ºä»“åº“ï¼Œæ¨èå‘½å `USER_NAME.github.io` ï¼ˆä¹‹åè®¾ç½® github pages æ—¶ï¼Œç½‘å€æ²¡æœ‰è·¯å¾„ï¼‰ã€‚æ¨é€ç«™ç‚¹ä»“åº“åˆ° github ã€‚

### é…ç½®æŒç»­é›†æˆ

ä½¿ç”¨ `github actions` ï¼Œè‡ªåŠ¨å»ºæ„ `hugo` å¹¶å‘å¸ƒåˆ° `github pages` å’Œ ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ã€‚

- github actions ï¼š æ˜¯ä¸€äº›æŒç»­é›†æˆçš„æ“ä½œï¼ŒåŒ…æ‹¬ä½†ä¸å±€é™äºï¼šæŠ“å–ä»£ç ã€è¿è¡Œæµ‹è¯•ã€ç™»å½•è¿œç¨‹æœåŠ¡å™¨ï¼Œå‘å¸ƒåˆ°ç¬¬ä¸‰æ–¹æœåŠ¡ç­‰ã€‚github å…è®¸å¼€å‘è€…ï¼ŒæŠŠæ¯ä¸ªæ“ä½œåç¨‹ç‹¬ç«‹çš„è„šæœ¬ï¼Œå­˜æ”¾åˆ°ä»£ç ä»“åº“ï¼Œä¾›ä»–äººè°ƒç”¨ã€‚[å®˜æ–¹å¸‚åœº](https://github.com/marketplace?category=&query=&type=actions&verification=)ï¼Œ[awesome-actions](https://github.com/sdras/awesome-actions)
- github pages ï¼šæ˜¯ä¸€ä¸ªé™æ€ç½‘å€æ‰˜ç®¡æœåŠ¡ï¼Œ`github` å…è®¸ä½ ä¸ºä½ çš„æ¯ä¸€ä¸ªä»“åº“ï¼Œåˆ¶ä½œä¸€ä¸ªé™æ€ç½‘é¡µã€‚

#### é…ç½® github actions

ä½ å¯ä»¥åœ¨ actions é€‰é¡¹å¡å†…æ–°å»º workflow ï¼›ä¹Ÿå¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰‹åŠ¨åˆ›å»º`.github\workflows\XXX.yml` ç„¶åæäº¤ï¼Œ action çš„é…ç½®æ–‡ä»¶å«åš workflow æ–‡ä»¶ã€‚ ä»¥ `.yml` ä¸ºåç¼€ã€‚

```yml
name: Hugo build and deploy
on:
  # å½“ main åˆ†æ”¯è¢« push æ—¶ï¼Œæ­¤ workflow è¢«è§¦å‘
  push:
    branches: [ main ]

  # å…è®¸ä½ åœ¨ actions é€‰é¡¹å¡ä¸­æ‰‹åŠ¨æ‰§è¡Œæ­¤ workflow 
  workflow_dispatch:
jobs:
  Hugo-build-deploy:
    runs-on: ubuntu-latest # åŸºäº ubuntu æœ€æ–°ç‰ˆ
    concurrency:
      group: ${{ github.workflow }}-${{ github.ref }}
    steps:
      - uses: actions/checkout@v2 # æ£€å‡ºä»£ç 
        with:
          submodules: true  # Fetch Hugo themes (true OR recursive)
          fetch-depth: 0    # Fetch all history for .GitInfo and .Lastmod

      - name: Setup Hugo # å®‰è£… hugo 
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: 'latest'
          extended: true

      - name: Build # å»ºæ„ hugo
        run: hugo --minify
        
      - name: Deploy Github Pages # éƒ¨ç½²åˆ° github pages
        uses: peaceiris/actions-gh-pages@v3
        if: ${{ github.ref == 'refs/heads/main' }}
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./public
      - name: ğŸ“‚ Sync files # ftp åŒæ­¥åˆ° ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼Œå¦‚æ— ç¬¬ä¸‰æ–¹æœåŠ¡å™¨å¯ä»¥çœç•¥æ­¤æ­¥ã€‚
        uses: SamKirkland/FTP-Deploy-Action@4.1.0
        with:
          server: ${{ secrets.FTP_URL }}
          username: ${{ secrets.FTP_USER }}
          password: ${{ secrets.FTP_PWD }}
          local-dir: ./public/
```

ps: æ•æ„Ÿå­—æ®µéœ€è¦åœ¨ `Settings/Secrets` é€‰é¡¹å¡ä¸­è®¾ç½®ï¼Œå¦‚ä¸Šçš„ `${{ secrets.FTP_PWD }}` ç­‰ã€‚

psï¼šå¯ä»¥åœ¨ actions é€‰é¡¹å¡ä¸­æŸ¥çœ‹ action è¿è¡ŒçŠ¶æ€ï¼Œå¹¶è°ƒè¯•é”™è¯¯ã€‚

#### é…ç½® github pages

å½“ä»¥ä¸Š actions æˆåŠŸè¿è¡Œä¸€æ¬¡åï¼ˆpush æ“ä½œåï¼Œæˆ– æ‰‹åŠ¨è¿è¡Œï¼‰ï¼Œä½ ä¼šå‘ç°å¤šäº†ä¸€ä¸ª `gh-pages` åˆ†æ”¯ã€‚

è¿›å…¥é€‰é¡¹å¡ `Settings/Pages` é…ç½® `source` ï¼Œ`branch` ä¸º `gh-pages`ï¼Œç›®å½•ä¸º `/(root)`ã€‚

æˆåŠŸåä¼šæç¤ºä½  `Your site is published at https://sunvdong.github.io/`  ï¼ˆå¦‚æœä½ çš„ä»“åº“åæ˜¯ `ä½ çš„ç”¨æˆ·å.github.io`ï¼Œåˆ™ç½‘å€åæ²¡æœ‰è·¯å¾„ï¼‰ã€‚

### å¢åŠ è¯„è®ºåŠŸèƒ½

å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š[Waline å¿«é€Ÿä¸Šæ‰‹](https://waline.js.org/guide/get-started.html)

1. LeanCloud è®¾ç½® (å‡†å¤‡æ•°æ®åº“)

   1. æ³¨å†Œ LeanCloud  å›½é™…ç‰ˆ ï¼ˆç”¨äºå­˜å‚¨æ•°æ®ï¼‰
   2. åœ¨ LeanCloud åˆ›å»ºåº”ç”¨
   3. è®°å½• id ï¼Œå¯†é’¥ç­‰ã€‚

2. Vercel éƒ¨ç½² (æœåŠ¡ç«¯)

   1. github ç™»å½• Vercel
   2. æ–°å»ºé¡¹ç›®ï¼Œåˆå§‹åŒ–ä»“åº“
   3. è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæ­¥éª¤1ï¼ˆç¬¬3å°æ­¥ï¼‰ä¸­è®°å½•çš„idç­‰
   4. é‡æ–°éƒ¨ç½²ï¼Œä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ
   5. é…ç½®åŸŸåï¼ˆé»˜è®¤åŸŸå xxxxxx.vercel.app å›½å†…ä¸èƒ½è®¿é—®ï¼‰
   6. åŸŸåæœåŠ¡å™¨å•†å¤„æ·»åŠ æ–°çš„ `CNAME` è§£æè®°å½•

3. ä¿®æ”¹ hugo é…ç½®æ–‡ä»¶  `config.toml`ï¼š

   ```toml
   [params.page]
       # è¯„è®ºç³»ç»Ÿè®¾ç½®
       [params.page.comment]
         enable = true
         # Waline è¯„è®ºç³»ç»Ÿè®¾ç½® (https://waline.js.org)
         [params.page.comment.waline]
           enable = true
           serverURL = "https://comment.vdong.xyz/" # æ­¤å¤„ä¸ºä¸Šè¾¹é…ç½®çš„åŸŸå
           pageview = true
           comment = true
           emoji = ['https://i.whaoot.com/emojis/qq/'] # emoji ä½¿ç”¨äº†ä¸ªäººä¸ƒç‰›äº‘å­˜å‚¨
           # emoji = ['https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo']
           # meta = ['nick', 'mail', 'link']
           # requiredMeta = []
           # login = 'enable'
           # wordLimit = 0
           # pageSize = 10
           # imageUploader = false
           # highlighter = false
           # texRenderer = false
   ```

### å¢åŠ æœç´¢åŠŸèƒ½

DoIt æ”¯æŒå¤šç§æœç´¢æ–¹å¼ï¼Œè¿™é‡Œä½¿ç”¨ Fuse.js ,åªéœ€è¦ä¿®æ”¹ hugo çš„é…ç½®æ–‡æ•™ `config.toml` å³å¯ï¼š

```toml
 [params.search]
    enable = true
    # æœç´¢å¼•æ“çš„ç±»å‹ ("lunr", "algolia", "fuse")
    type = "fuse"
    # æ–‡ç« å†…å®¹æœ€é•¿ç´¢å¼•é•¿åº¦
    contentLength = 4000
    # æœç´¢æ¡†çš„å ä½æç¤ºè¯­
    placeholder = "æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..."
    # DoIt æ–°å¢ | 0.2.1 æœ€å¤§ç»“æœæ•°ç›®
    maxResultLength = 10
    # DoIt æ–°å¢ | 0.2.3 ç»“æœå†…å®¹ç‰‡æ®µé•¿åº¦
    snippetLength = 50
    # DoIt æ–°å¢ | 0.2.1 æœç´¢ç»“æœä¸­é«˜äº®éƒ¨åˆ†çš„ HTML æ ‡ç­¾
    highlightTag = "em"
    # DoIt æ–°å¢ | 0.2.4 æ˜¯å¦åœ¨æœç´¢ç´¢å¼•ä¸­ä½¿ç”¨åŸºäº baseURL çš„ç»å¯¹è·¯å¾„
    absoluteURL = false
    [params.search.fuse]
      # DoIt æ–°å¢ | 0.2.12 https://fusejs.io/api/options.html
      isCaseSensitive = false
      minMatchCharLength = 2
      findAllMatches = false
      location = 0
      threshold = 0.3
      distance = 100
      ignoreLocation = false
      useExtendedSearch = false
      ignoreFieldNorm = false
```

### é…ç½®æ–‡ç« ä¿®æ”¹æ—¶é—´

hugo é…ç½®æ–‡ä»¶ä¸­æ–°å¢å¦‚ä¸‹ï¼š

- `:git` ä»æ–‡ä»¶çš„ git æäº¤è®°å½•è·å–
- `lastmod` ä»æ–‡ä»¶ä¸­çš„ `lastmod` å­—æ®µè·å–
- `:fileModTime` ä»æ–‡ä»¶ä¿®æ”¹æ—¶é—´è·å–

```toml
enableGitInfo = true # è·å–æ¯ä¸ªæ–‡ä»¶çš„gitä¿®æ”¹ä¿¡æ¯
[frontmatter]
  lastmod = [':git', 'lastmod', ':fileModTime', ':default']
```

## é—®é¢˜è®°å½•

### å­æ¨¡å—æœªåˆå§‹åŒ–æˆ–æ›´æ–°å¯¼è‡´ï¼Œhugo server -D ä¸èƒ½é¢„è§ˆç½‘ç«™é—®é¢˜

åŸå› æ˜¯ï¼šå­æ¨¡å—æœªåˆå§‹åŒ–ï¼Œå¯¼è‡´æ¨¡æ¿ç¼ºå¤±ï¼Œä»è€Œä¸èƒ½ç”Ÿæˆ html æ–‡ä»¶ã€‚
```shell
# åˆå§‹åŒ–å­æ¨¡å—
git submodule init

# æ›´æ–°å­æ¨¡å—
git submodule update --remote

# æŸ¥çœ‹æ›´æ–°çŠ¶æ€
git submodule status

```

### ä½¿ç”¨ Typora ç¼–è¾‘ md æ–‡ä»¶æ—¶çš„å›¾ç‰‡è®¾ç½®é—®é¢˜

1. æ–‡ä»¶ -> åå¥½è®¾ç½® -> å›¾åƒ -> æ’å…¥å›¾ç‰‡æ—¶..  é€‰æ‹© å¤åˆ¶åˆ°æŒ‡å®šè·¯å¾„ï¼Œå¹¶æŒ‡å®šè·¯å¾„ä¸ºï¼Œ`hugo\static\imgs\${filename}\` ã€‚ 
2. æ ¼å¼( Format ) -> å›¾åƒ( Image ) -> è®¾ç½®å›¾ç‰‡æ ¹ç›®å½•( Use Image Root Path )ï¼Œç›®å½•é€‰æ‹©åˆ° imgs çš„ä¸Šä¸€çº§ static ç›®å½•ï¼Œè¿™æ—¶ Typora ä¼šå¢åŠ ä¸€ä¸ª Markdown æ–‡ä»¶é¡¶éƒ¨çš„å…ƒæ•°æ®ï¼ˆymlæ ¼å¼ï¼‰ `typora-root-url: "..\\..\\..\\static"`ï¼ˆæ¯ä¸ªæ–‡ä»¶éƒ½å¾—è®¾ç½®ï¼Œä¸æ¨èï¼‰ã€‚
3. ç›´æ¥ä¿®æ”¹ï¼Œ`archetypes/default.md` æ¨¡æ¿æ–‡ä»¶ï¼Œå¢åŠ å…ƒæ•°æ® ymlæ ¼å¼ï¼š`typora-root-url: "..\\..\\..\\static"` æˆ– tomlæ ¼å¼ï¼š`typora-root-url = "..\\..\\..\\static"`ï¼Œä¹‹ååœ¨æ–°å»º md æ–‡ä»¶æ—¶å°±è‡ªåŠ¨å¢åŠ äº†ã€‚

## æˆæœ

æºç ï¼š[https://github.com/SunVdong/sunvdong.github.io](https://github.com/SunVdong/sunvdong.github.io)

åšå®¢åœ°å€: [https://www.vdong.xyz](https://www.vdong.xyz) or [https://sunvdong.github.io](https://sunvdong.github.io)

## å‚è€ƒ

[Hugoå®˜ç½‘](https://gohugo.io/)

[GitHub Actions å…¥é—¨æ•™ç¨‹](http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html)

[ä½¿ç”¨ Hugo + Github æ­å»ºä¸ªäººåšå®¢](https://zhuanlan.zhihu.com/p/105021100)

[hugoä¸typoraå›¾ç‰‡è·¯å¾„ç»Ÿä¸€é—®é¢˜](https://blog.bitllion.top/posts/hugo%E4%B8%8Etypora%E5%9B%BE%E7%89%87%E8%B7%AF%E5%BE%84%E7%BB%9F%E4%B8%80%E9%97%AE%E9%A2%98/)



